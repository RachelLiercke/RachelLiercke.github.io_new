<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rachel Liercke" />

<meta name="date" content="2022-12-01" />

<title>Case2 Project</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="RachelLierckeCase2.html">DDS Case 2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Case2 Project</h1>
<h4 class="author">Rachel Liercke</h4>
<h4 class="date">2022-12-01</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div
id="ddsanalytics-has-been-asked-by-a-fortune-100-company-to-run-a-thorough-analysis-on-predicting-if-a-person-stayleaves-attrition-as-well-as-salary-based-on-a-dataset-of-numerous-variables."
class="section level2">
<h2>DDSAnalytics has been asked by a Fortune 100 company to run a
thorough analysis on predicting if a person stay/leaves (Attrition) as
well as Salary based on a dataset of numerous variables.</h2>
</div>
<div
id="i-have-been-tasked-with-finding-the-top-three-variables-that-influence-attrition-and-determing-models-that-best-fit-the-prediction-of-attrition-and-salary-given-a-dataset-without-these-respective-values."
class="section level2">
<h2>I have been tasked with finding the top three variables that
influence Attrition, and determing models that best fit the prediction
of Attrition and Salary given a dataset without these respective
values.</h2>
</div>
<div
id="i-will-discuss-below-what-work-has-been-done-to-provide-these-details."
class="section level2">
<h2>I will discuss below what work has been done to provide these
details.</h2>
<div
id="to-start-upload-the-files-case2-along-with-the-no-attrition-and-no-salary-files.-also-download-any-packages-that-will-be-needed-to-complete-the-analysis."
class="section level3">
<h3>To start, upload the files (case2), along with the No Attrition and
No Salary files. Also, download any packages that will be needed to
complete the analysis.</h3>
<pre class="r"><code>library(RCurl) 
library(jsonlite)
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.8     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.2
## ── Conflicts ───────────────────────────────────────── tidyverse_conflicts() ──
## ✖ tidyr::complete() masks RCurl::complete()
## ✖ dplyr::filter()   masks stats::filter()
## ✖ purrr::flatten()  masks jsonlite::flatten()
## ✖ dplyr::lag()      masks stats::lag()</code></pre>
<pre class="r"><code>library(aws.s3)
library(caret)</code></pre>
<pre><code>## Loading required package: lattice
## 
## Attaching package: &#39;caret&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>library(class)
library(olsrr)</code></pre>
<pre><code>## 
## Attaching package: &#39;olsrr&#39;
## 
## The following object is masked from &#39;package:datasets&#39;:
## 
##     rivers</code></pre>
<pre class="r"><code>library(readxl)
library(e1071)
library(ggplot2)
library(ggthemes)
library(GGally)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre class="r"><code>library(dplyr)


#Read in case2 file
case2 &lt;- read.csv(&quot;C:/Users/rache/Documents/DDS/Unit 14/case2.csv&quot;)

#Read in case2 No attrition file
case2NA &lt;- read.csv(&quot;C:/Users/rache/Documents/DDS/Unit 14/CaseStudy2CompSet_No_Attrition.csv&quot;)

#Read in case2 No salary file
case2NS &lt;- read_excel(&quot;C:/Users/rache/Documents/DDS/Unit 14/CaseStudy2CompSet_No_Salary.xlsx&quot;)</code></pre>
</div>
<div
id="we-will-remove-the-variables-that-wont-influence-the-data-because-they-are-all-the-same-values"
class="section level3">
<h3>We will remove the variables that won’t influence the data because
they are all the same values</h3>
<pre class="r"><code>#Time to get to work: Find linear regression model 
#And which factors might be influential

case2x &lt;- case2[,-10]
case2x &lt;- case2x[,-22]
case2x &lt;- case2x[,-26]</code></pre>
</div>
<div
id="change-the-variables-that-are-character-into-factors-so-we-can-use-linear-regression."
class="section level3">
<h3>Change the variables that are character into factors so we can use
linear regression.</h3>
<pre class="r"><code>#change variables to factors and rename the levels to factored values
case2x$BusinessTravel &lt;- as.factor(case2x$BusinessTravel)
case2x$Department &lt;- as.factor(case2x$Department)
case2x$EducationField &lt;- as.factor(case2x$EducationField)
case2x$Gender &lt;- as.factor(case2x$Gender)
case2x$JobRole &lt;- as.factor(case2x$JobRole)
case2x$MaritalStatus &lt;- as.factor(case2x$MaritalStatus)
case2x$OverTime &lt;- as.factor(case2x$OverTime)
case2x$Attrition &lt;- as.factor(case2x$Attrition)


#Gender levels: 1=Male 2=Female
levels(case2x$Gender) &lt;- c(1,2)
levels(case2x$Gender)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
<pre class="r"><code>#OverTime levels: 1=Yes 2=No
levels(case2x$OverTime) &lt;- c(1,2)
levels(case2x$OverTime)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
<pre class="r"><code>#MaritalStatus levels: 1=Divorced 2=Married 3=Single
levels(case2x$MaritalStatus) &lt;- c(1,2,3)
levels(case2x$MaritalStatus)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>#BusinessTravel levels:1=Non-Travel, 2=Travel Frequently 3=Travel Rarely
levels(case2x$BusinessTravel) &lt;- c(1,2,3)
levels(case2x$BusinessTravel)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>#Department levels: 1=Human Resources(HR) 2=Research &amp; Development(R&amp;D) 3= Sales
levels(case2x$Department) &lt;- c(1,2,3)
levels(case2x$Department)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>#EducationField levels: 1= Human Resources(HR) 2=Life Sciences 3=Marketing
# 4=Medical 5=Other 6=Technical Degree
levels(case2x$EducationField) &lt;- c(1,2,3,4,5,6)
levels(case2x$EducationField)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<pre class="r"><code>#JobRole levels: 1=Healthcare Representative 2=Human Resources 3=Laboratory Tech
# 4=Manager 5=Manufacturing Director 6=Research Director
# 7=Research Scientist 8=Sales Executive 9=Sales Representative
levels(case2x$JobRole) &lt;- c(1,2,3,4,5,6,7,8,9)
levels(case2x$JobRole)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot;</code></pre>
<pre class="r"><code>#Attrition levels:
levels(case2x$Attrition) &lt;- c(1,2)
levels(case2x$Attrition)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
<pre class="r"><code>case2x&lt;-na.omit(case2x)



case2x$OverTime&lt;- as.numeric(case2x$OverTime)
case2x$BusinessTravel &lt;- as.numeric(case2x$BusinessTravel)
case2x$Department &lt;- as.numeric(case2x$Department)
case2x$EducationField &lt;- as.numeric(case2x$EducationField)
case2x$Gender &lt;- as.numeric(case2x$Gender)
case2x$JobRole &lt;- as.numeric(case2x$JobRole)
case2x$MaritalStatus &lt;- as.numeric(case2x$MaritalStatus)
case2x$Attrition &lt;- as.integer(case2x$Attrition)</code></pre>
</div>
</div>
<div id="to-start-we-will-look-at-some-job-trends-that-we-found."
class="section level2">
<h2>To start we will look at some job trends that we found.</h2>
<div
id="we-will-initally-look-at-a-ggpairs-plot-of-3-variables-that-i-think-will-be-influential-to-job-role."
class="section level3">
<h3>We will initally look at a ggpairs plot of 3 variables that I think
will be influential to Job Role.</h3>
<pre class="r"><code>#To give us an idea of the distribution of Job Roles. We can see that Sales Executive has the highest number of participants in this dataset.
case2%&gt;%ggplot(aes(x=JobRole, fill=JobRole)) +geom_histogram(stat = &quot;count&quot;) + ggtitle(&quot;Job Role Distribution&quot;)+
  theme_solarized()</code></pre>
<pre><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>#pairs of what I think is important
case2%&gt;% select(JobSatisfaction,JobRole,OverTime,MaritalStatus)%&gt;% ggpairs(aes(color=JobRole))</code></pre>
<pre><code>## 
 plot: [1,1] [==&gt;----------------------------------------------]  6% est: 0s 
 plot: [1,2] [=====&gt;-------------------------------------------] 12% est: 1s 
 plot: [1,3] [========&gt;----------------------------------------] 19% est: 2s 
 plot: [1,4] [===========&gt;-------------------------------------] 25% est: 2s 
 plot: [2,1] [==============&gt;----------------------------------] 31% est: 2s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [2,2] [=================&gt;-------------------------------] 38% est: 2s 
 plot: [2,3] [====================&gt;----------------------------] 44% est: 2s 
 plot: [2,4] [=======================&gt;-------------------------] 50% est: 2s 
 plot: [3,1] [===========================&gt;---------------------] 56% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==============================&gt;------------------] 62% est: 1s 
 plot: [3,3] [=================================&gt;---------------] 69% est: 1s 
 plot: [3,4] [====================================&gt;------------] 75% est: 1s 
 plot: [4,1] [=======================================&gt;---------] 81% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [==========================================&gt;------] 88% est: 0s 
 plot: [4,3] [=============================================&gt;---] 94% est: 0s 
 plot: [4,4] [=================================================]100% est: 0s 
                                                                             </code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-4-2.png" width="672" />
### We can see that this plot doesn’t give us very many trends so we
will explore some these individually. ### We will look at this in a
count plot and then at percentages so we can easily compare the
difference</p>
<pre class="r"><code>#Based on this look at job role and job satisfaction
x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=JobSatisfaction,fill=JobRole)) +geom_bar(stat = &#39;count&#39;,color =&quot;black&quot;) + ggtitle(&quot;Job Satisfaction by Job Role&quot;)+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>#percentages
y&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=JobSatisfaction,fill=JobRole)) +geom_bar(position=&quot;fill&quot;,color =&quot;black&quot;) + ggtitle(&quot;Job Satisfaction by Job Role&quot;)+
  theme_solarized() 
  
  
  

#OverTime
x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=OverTime,fill=JobRole)) +geom_bar(stat = &#39;count&#39;,color =&quot;black&quot;) + ggtitle(&quot;OverTime by Job Role&quot; )+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<pre class="r"><code>x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=OverTime,fill=JobRole)) +geom_bar(position=&quot;fill&quot;,color =&quot;black&quot;) + ggtitle(&quot;OverTime by Job Role&quot;)+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-5-3.png" width="672" /></p>
<pre class="r"><code>#MaritalStatus
x&lt;-case2%&gt;%
  ggplot(aes(x=MaritalStatus)) +geom_bar(stat = &#39;count&#39;,color =&quot;black&quot;) + ggtitle(&quot;Marital Status by Job Role&quot; )+
  theme_solarized() +facet_grid(rows=vars(JobRole))

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-5-4.png" width="672" /></p>
<pre class="r"><code>x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=MaritalStatus,fill=JobRole)) +geom_bar(position=&quot;fill&quot;,color =&quot;black&quot;) + ggtitle(&quot;Marital Status Percentage by Job Role&quot;)+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-5-5.png" width="672" /></p>
</div>
</div>
<div
id="of-these-give-us-any-good-trends-so-we-will-run-a-linear-regression-model-to-determine-which-factors-influence-job-role-the-most."
class="section level2">
<h2>of these give us any good trends so we will run a Linear Regression
model to determine which factors influence job role the most.</h2>
<pre class="r"><code>#Look at factors that influence Job Role the most
fitJR&lt;- lm(JobRole~.,data=case2x)
summary(fitJR)</code></pre>
<pre><code>## 
## Call:
## lm(formula = JobRole ~ ., data = case2x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5313 -1.4622  0.3645  1.2618  4.1659 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               2.570e-01  1.082e+00   0.237  0.81237    
## ID                       -2.366e-04  2.468e-04  -0.958  0.33817    
## Age                      -6.463e-03  9.443e-03  -0.684  0.49389    
## Attrition                -1.012e-01  1.905e-01  -0.532  0.59521    
## BusinessTravel           -4.246e-02  9.127e-02  -0.465  0.64194    
## DailyRate                -7.125e-05  1.532e-04  -0.465  0.64192    
## Department                3.224e+00  1.202e-01  26.829  &lt; 2e-16 ***
## DistanceFromHome          1.279e-04  7.666e-03   0.017  0.98669    
## Education                 1.253e-01  6.185e-02   2.027  0.04300 *  
## EducationField           -2.847e-02  4.644e-02  -0.613  0.54003    
## EmployeeNumber           -7.337e-05  1.017e-04  -0.721  0.47092    
## EnvironmentSatisfaction  -3.813e-02  5.624e-02  -0.678  0.49795    
## Gender                   -5.412e-02  1.247e-01  -0.434  0.66440    
## HourlyRate               -1.987e-03  3.063e-03  -0.649  0.51669    
## JobInvolvement            3.528e-02  8.903e-02   0.396  0.69205    
## JobLevel                 -1.026e+00  1.948e-01  -5.270 1.74e-07 ***
## JobSatisfaction          -2.258e-02  5.616e-02  -0.402  0.68776    
## MaritalStatus            -3.925e-02  1.135e-01  -0.346  0.72956    
## MonthlyIncome             1.926e-04  4.524e-05   4.256 2.31e-05 ***
## MonthlyRate               1.037e-06  8.651e-06   0.120  0.90461    
## NumCompaniesWorked        1.083e-02  2.824e-02   0.383  0.70159    
## OverTime                  3.853e-01  1.405e-01   2.742  0.00624 ** 
## PercentSalaryHike         3.356e-02  2.640e-02   1.271  0.20401    
## PerformanceRating        -3.644e-01  2.694e-01  -1.353  0.17644    
## RelationshipSatisfaction -2.548e-02  5.586e-02  -0.456  0.64834    
## StockOptionLevel         -7.687e-02  9.485e-02  -0.810  0.41793    
## TotalWorkingYears        -1.177e-02  1.839e-02  -0.640  0.52253    
## TrainingTimesLastYear    -1.004e-01  4.851e-02  -2.069  0.03884 *  
## WorkLifeBalance           9.762e-02  8.652e-02   1.128  0.25950    
## YearsAtCompany           -6.385e-03  2.282e-02  -0.280  0.77970    
## YearsInCurrentRole        1.374e-02  2.849e-02   0.482  0.62981    
## YearsSinceLastPromotion  -1.948e-02  2.561e-02  -0.760  0.44721    
## YearsWithCurrManager      1.158e-03  2.795e-02   0.041  0.96697    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.783 on 837 degrees of freedom
## Multiple R-squared:  0.4939, Adjusted R-squared:  0.4746 
## F-statistic: 25.53 on 32 and 837 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#use only the influential from original
fitJR2&lt;- lm(JobRole~Department+JobLevel+MonthlyIncome+Education+OverTime+TrainingTimesLastYear,data=case2x)
summary(fitJR2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = JobRole ~ Department + JobLevel + MonthlyIncome + 
##     Education + OverTime + TrainingTimesLastYear, data = case2x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1355 -1.5544  0.3863  1.3604  3.6593 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -1.350e+00  3.927e-01  -3.437 0.000616 ***
## Department             3.255e+00  1.160e-01  28.054  &lt; 2e-16 ***
## JobLevel              -1.095e+00  1.829e-01  -5.989 3.10e-09 ***
## MonthlyIncome          1.863e-04  4.316e-05   4.318 1.76e-05 ***
## Education              1.235e-01  5.932e-02   2.082 0.037681 *  
## OverTime               3.543e-01  1.325e-01   2.673 0.007656 ** 
## TrainingTimesLastYear -1.018e-01  4.739e-02  -2.148 0.031973 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.769 on 863 degrees of freedom
## Multiple R-squared:  0.4866, Adjusted R-squared:  0.483 
## F-statistic: 136.3 on 6 and 863 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div
id="we-can-see-from-the-first-lm-model-that-departmentjoblevel-monthlyincomeeducationovertime-and-training-times-influence-this-the-most.-we-will-explore-this-in-a-ggpairs-model-of-the-top-3."
class="section level2">
<h2>We can see from the first LM model that Department,JobLevel,
MonthlyIncome,Education,OverTime, and Training times influence this the
most. We will explore this in a ggpairs model of the top 3.</h2>
<pre class="r"><code>case2%&gt;% select(Department,JobRole,JobLevel,MonthlyIncome)%&gt;% ggpairs(aes(color=JobRole))</code></pre>
<pre><code>## 
 plot: [1,1] [==&gt;----------------------------------------------]  6% est: 0s 
 plot: [1,2] [=====&gt;-------------------------------------------] 12% est: 1s 
 plot: [1,3] [========&gt;----------------------------------------] 19% est: 1s 
 plot: [1,4] [===========&gt;-------------------------------------] 25% est: 1s 
 plot: [2,1] [==============&gt;----------------------------------] 31% est: 1s 
 plot: [2,2] [=================&gt;-------------------------------] 38% est: 1s 
 plot: [2,3] [====================&gt;----------------------------] 44% est: 1s 
 plot: [2,4] [=======================&gt;-------------------------] 50% est: 1s 
 plot: [3,1] [===========================&gt;---------------------] 56% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,2] [==============================&gt;------------------] 62% est: 1s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [3,3] [=================================&gt;---------------] 69% est: 1s 
 plot: [3,4] [====================================&gt;------------] 75% est: 1s 
 plot: [4,1] [=======================================&gt;---------] 81% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,2] [==========================================&gt;------] 88% est: 0s `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## 
 plot: [4,3] [=============================================&gt;---] 94% est: 0s 
 plot: [4,4] [=================================================]100% est: 0s 
                                                                             </code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-7-1.png" width="672" />
## Most of these directly correlate to the position themselves, so we
will take a look at monthly income, education and training times.</p>
<pre class="r"><code>#Education
x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=Education,fill=JobRole)) +geom_bar(stat = &#39;count&#39;,color =&quot;black&quot;) + ggtitle(&quot;Education by Job Role&quot; )+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>#percentage
x&lt;-case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=Education,fill=JobRole)) +geom_bar(position =&quot;fill&quot;,color =&quot;black&quot;) + ggtitle(&quot;Education by Job Role&quot; )+
  theme_solarized()  

x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>case2 %&gt;% group_by(JobRole)%&gt;% ggplot(aes(x=Education,fill=JobRole))+
  geom_histogram(alpha=0.5,position=&quot;identity&quot;,color=&quot;black&quot;)+
  ggtitle(&quot;Education Levels by Job Role&quot;)+facet_grid(rows=vars(JobRole))</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre class="r"><code>#look at Training Times
x=case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=TrainingTimesLastYear, fill=JobRole)) +geom_bar(position= &#39;dodge&#39;) + ggtitle(&quot;Trainings by Job Role&quot;)+
  theme_solarized()
x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-4.png" width="672" /></p>
<pre class="r"><code>#percentages
x=case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(x=TrainingTimesLastYear, fill=JobRole)) +geom_bar(position= &#39;fill&#39;) + ggtitle(&quot;Training Percentages by Job Role&quot;)+
  theme_solarized()
x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-5.png" width="672" /></p>
<pre class="r"><code>#monthly income
x=case2%&gt;%group_by(JobRole)%&gt;%
  ggplot(aes(y=OverTime,x=MonthlyIncome, color=JobRole)) +geom_point() +
  theme_solarized()
  x + scale_fill_hc()</code></pre>
<p><img src="RachelLierckeCase2_files/figure-html/unnamed-chunk-8-6.png" width="672" /></p>
</div>
<div
id="we-then-looked-into-the-factors-that-predicted-monthly-incomesalary-by-running-a-linear-regression-model"
class="section level2">
<h2>We then looked into the factors that predicted Monthly
Income(Salary) by running a linear regression model</h2>
<pre class="r"><code>#Salary model prediction

#Check all variables for Salary Prediction
fitSal &lt;- lm(MonthlyIncome~.,data=case2x)
summary(fitSal)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ ., data = case2x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5841.8  -783.9   -44.3   739.5  4282.8 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              -8.541e+02  8.175e+02  -1.045  0.29644    
## ID                       -2.275e-01  1.865e-01  -1.220  0.22299    
## Age                      -2.705e+00  7.139e+00  -0.379  0.70482    
## Attrition                 1.178e+02  1.440e+02   0.818  0.41334    
## BusinessTravel            1.833e+02  6.871e+01   2.668  0.00777 ** 
## DailyRate                -2.372e-02  1.158e-01  -0.205  0.83773    
## Department               -7.398e+02  1.212e+02  -6.103 1.59e-09 ***
## DistanceFromHome         -1.543e+01  5.770e+00  -2.673  0.00766 ** 
## Education                -7.884e+00  4.686e+01  -0.168  0.86644    
## EducationField            5.111e+00  3.511e+01   0.146  0.88429    
## EmployeeNumber            5.553e-02  7.689e-02   0.722  0.47041    
## EnvironmentSatisfaction  -7.033e+01  4.245e+01  -1.657  0.09794 .  
## Gender                    6.999e+01  9.424e+01   0.743  0.45790    
## HourlyRate                1.817e+00  2.315e+00   0.785  0.43270    
## JobInvolvement            8.060e+01  6.725e+01   1.199  0.23103    
## JobLevel                  3.825e+03  7.011e+01  54.558  &lt; 2e-16 ***
## JobRole                   1.100e+02  2.585e+01   4.256 2.31e-05 ***
## JobSatisfaction           8.515e+00  4.246e+01   0.201  0.84110    
## MaritalStatus            -3.496e+00  8.580e+01  -0.041  0.96751    
## MonthlyRate              -5.172e-03  6.537e-03  -0.791  0.42907    
## NumCompaniesWorked       -9.663e+00  2.135e+01  -0.453  0.65091    
## OverTime                 -4.468e+01  1.067e+02  -0.419  0.67546    
## PercentSalaryHike         2.909e+01  1.995e+01   1.458  0.14512    
## PerformanceRating        -2.757e+02  2.036e+02  -1.354  0.17606    
## RelationshipSatisfaction  1.699e+01  4.222e+01   0.402  0.68754    
## StockOptionLevel          1.070e+01  7.172e+01   0.149  0.88145    
## TotalWorkingYears         6.602e+01  1.372e+01   4.813 1.76e-06 ***
## TrainingTimesLastYear     3.709e+01  3.674e+01   1.010  0.31300    
## WorkLifeBalance          -3.637e+01  6.544e+01  -0.556  0.57847    
## YearsAtCompany           -1.132e+01  1.725e+01  -0.656  0.51177    
## YearsInCurrentRole       -6.526e+00  2.154e+01  -0.303  0.76194    
## YearsSinceLastPromotion   1.219e+01  1.936e+01   0.630  0.52908    
## YearsWithCurrManager     -4.446e+01  2.107e+01  -2.110  0.03517 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1348 on 837 degrees of freedom
## Multiple R-squared:  0.9172, Adjusted R-squared:  0.914 
## F-statistic: 289.7 on 32 and 837 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#These are the most significant influencers of salary
fitSal2 &lt;- lm(MonthlyIncome~BusinessTravel+Department+DistanceFromHome+JobLevel+JobRole+TotalWorkingYears+YearsWithCurrManager,data=case2x)
summary(fitSal2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ BusinessTravel + Department + DistanceFromHome + 
##     JobLevel + JobRole + TotalWorkingYears + YearsWithCurrManager, 
##     data = case2x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5722.8  -759.6    -8.9   744.1  4146.7 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          -1129.227    288.508  -3.914 9.79e-05 ***
## BusinessTravel         186.335     67.612   2.756 0.005976 ** 
## Department            -725.040    118.734  -6.106 1.54e-09 ***
## DistanceFromHome       -14.471      5.602  -2.583 0.009957 ** 
## JobLevel              3806.034     68.316  55.712  &lt; 2e-16 ***
## JobRole                110.178     25.282   4.358 1.47e-05 ***
## TotalWorkingYears       60.434     10.297   5.869 6.24e-09 ***
## YearsWithCurrManager   -53.232     14.381  -3.702 0.000228 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1340 on 862 degrees of freedom
## Multiple R-squared:  0.9158, Adjusted R-squared:  0.9151 
## F-statistic:  1339 on 7 and 862 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#JobLevel has the highest correlation to MonthlyIncome with TotalWorkingYears as the next highest.
#RMSE for this model is 1387.30 (which is well below the 3000 threshold).
fitSal3 &lt;- lm(MonthlyIncome~JobLevel+TotalWorkingYears+YearsWithCurrManager,data=case2x)

summary(fitSal3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = MonthlyIncome ~ JobLevel + TotalWorkingYears + YearsWithCurrManager, 
##     data = case2x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5643.3  -874.3    34.4   722.3  3920.6 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          -1699.16     102.13 -16.636  &lt; 2e-16 ***
## JobLevel              3717.24      68.62  54.175  &lt; 2e-16 ***
## TotalWorkingYears       68.34      10.44   6.545 1.01e-10 ***
## YearsWithCurrManager   -59.33      14.74  -4.026 6.18e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1378 on 866 degrees of freedom
## Multiple R-squared:  0.9105, Adjusted R-squared:  0.9102 
## F-statistic:  2938 on 3 and 866 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div
id="we-will-use-this-model-to-predict-the-dataset-with-no-salaryincome-data.-we-have-included-this-as-an-csv-document."
class="section level2">
<h2>We will use this model to predict the dataset with no Salary/Income
data. We have included this as an csv document.</h2>
<pre class="r"><code>predictionSal = predict(fitSal3,case2NS)
predictionSal</code></pre>
<pre><code>##         1         2         3         4         5         6         7 
##  5798.363  2241.103 14335.229  2241.103  2081.121  7033.711  5866.699 
##         8         9        10        11        12        13        14 
##  2036.095  2167.467 14973.564 11187.985  2318.444  6026.681  6017.676 
##        15        16        17        18        19        20        21 
##  6418.687  5890.009  6131.038  6213.679  6003.371  2190.777  5875.704 
##        22        23        24        25        26        27        28 
##  9889.601  9652.277  5908.020 11018.998  9857.285 10204.266 14011.559 
##        29        30        31        32        33        34        35 
##  6062.702  2309.439  2309.439  6487.023  6550.059  2564.773 14887.217 
##        36        37        38        39        40        41        42 
##  5890.009 10590.971  6044.692  2036.095  2086.421 18180.138  2377.775 
##        43        44        45        46        47        48        49 
##  2377.775  9934.626  6222.684  5958.345  2104.431  5958.345  2086.421 
##        50        51        52        53        54        55        56 
##  2838.117  2172.767  2027.090  6350.351  6240.695 15214.592  2286.129 
##        57        58        59        60        61        62        63 
##  5944.040 10166.650  2086.421  2208.787  6345.051  9720.613  9720.613 
##        64        65        66        67        68        69        70 
##  2223.093  2086.421  2291.429 10436.289 10504.625  6550.059  2086.421 
##        71        72        73        74        75        76        77 
##  3043.125  9848.280 10832.000  5890.009  2018.085  5967.350  2086.421 
##        78        79        80        81        82        83        84 
##  2104.431  2564.773  6104.022  2523.452  5985.361  6222.684  2309.439 
##        85        86        87        88        89        90        91 
##  6172.358  9889.601 11862.340  2286.129 10768.964 19145.848  2131.446 
##        92        93        94        95        96        97        98 
##  5935.035  6505.033  6199.374  2095.426 18394.151  2122.441 10135.930 
##        99       100       101       102       103       104       105 
## 15237.902  2241.103  5798.363  6122.033  2241.103  2086.421  5958.345 
##       106       107       108       109       110       111       112 
##  2232.098  6915.050  2250.108  9724.318 18458.782  2309.439 10358.948 
##       113       114       115       116       117       118       119 
##  2309.439  2359.765  6282.015  2386.780  2086.421  6035.686 10412.979 
##       120       121       122       123       124       125       126 
##  2104.431  6386.372  2122.441  6140.043  6077.007  5967.350  6235.394 
##       127       128       129       130       131       132       133 
##  2104.431 14736.240  9797.954  2027.090  6710.042  6077.007  6062.702 
##       134       135       136       137       138       139       140 
##  6864.724  2345.459  6291.020  2036.095  6300.025 18248.474  6327.041 
##       141       142       143       144       145       146       147 
## 10614.282  6555.359  6089.717  6071.707  6291.020  2446.111  2226.798 
##       148       149       150       151       152       153       154 
##  9779.944 10035.278  2018.085  5935.035  6213.679  6095.017 10923.646 
##       155       156       157       158       159       160       161 
## 14189.552 18144.118  6350.351  5899.014  6008.671 10736.648  5890.009 
##       162       163       164       165       166       167       168 
##  2226.798  9592.946  2086.421  6071.707  2027.090  5908.020 10486.615 
##       169       170       171       172       173       174       175 
##  9948.932  6427.692  2190.777  2309.439  9898.606  6312.735  2122.441 
##       176       177       178       179       180       181       182 
##  2086.421  5976.356  9797.954  2149.457  6095.017 11242.016  2149.457 
##       183       184       185       186       187       188       189 
##  6163.353  2309.439  2309.439  2309.439  6145.343 14139.226  6618.395 
##       190       191       192       193       194       195       196 
##  2190.777  6149.048  6231.689  6345.051  2104.431  6436.697  2241.103 
##       197       198       199       200       201       202       203 
##  3266.143 18548.834  5899.014  2172.767  2359.765  5911.724  2036.095 
##       204       205       206       207       208       209       210 
##  6003.371  6145.343 14549.242 18189.143  6300.025  6003.371  6915.050 
##       211       212       213       214       215       216       217 
##  2446.111  2232.098  2086.421  6226.389  9661.282 10107.319  6026.681 
##       218       219       220       221       222       223       224 
##  2368.770  2250.108  5908.020  5798.363  6107.727  9720.613  6035.686 
##       225       226       227       228       229       230       231 
##  5848.689  6104.022  3061.135  2309.439  2149.457  5944.040 17788.132 
##       232       233       234       235       236       237       238 
##  6104.022  6327.041 11607.006  2505.442  2505.442  2158.462  6300.025 
##       239       240       241       242       243       244       245 
##  5798.363  5908.020  6226.389 10171.950 10062.293  6787.383 10508.330 
##       246       247       248       249       250       251       252 
##  2386.780  6906.044  6122.033 10855.310  2208.787 10819.290 14955.553 
##       253       254       255       256       257       258       259 
##  6003.371 14198.557  2154.757  2086.421  2309.439  6113.028 14435.881 
##       260       261       262       263       264       265       266 
##  2232.098  9948.932 14486.206  6300.025  2113.436  2464.121  2250.108 
##       267       268       269       270       271       272       273 
##  3001.804  6003.371  9842.980 13473.876  5944.040  6300.025 10822.995 
##       274       275       276       277       278       279       280 
##  5890.009  6573.369  6222.684  6026.681  2172.767  2104.431  6012.376 
##       281       282       283       284       285       286       287 
##  2113.436  6282.015  6924.055  2086.421  6176.063 14604.868  2241.103 
##       288       289       290       291       292       293       294 
##  6760.367  2172.767  6154.348  2309.439 10135.930  2176.472 10153.940 
##       295       296       297       298       299       300 
##  2149.457  2036.095 10349.943  5908.020  2250.108  2149.457</code></pre>
<pre class="r"><code>predictionSal2&lt;- data.frame(MonthlyIncome = predictionSal)
predSal = data.frame(ID = case2NS[1], MonthlyIncome = predictionSal2)
predSal</code></pre>
<pre><code>##       ID MonthlyIncome
## 1    871      5798.363
## 2    872      2241.103
## 3    873     14335.229
## 4    874      2241.103
## 5    875      2081.121
## 6    876      7033.711
## 7    877      5866.699
## 8    878      2036.095
## 9    879      2167.467
## 10   880     14973.564
## 11   881     11187.985
## 12   882      2318.444
## 13   883      6026.681
## 14   884      6017.676
## 15   885      6418.687
## 16   886      5890.009
## 17   887      6131.038
## 18   888      6213.679
## 19   889      6003.371
## 20   890      2190.777
## 21   891      5875.704
## 22   892      9889.601
## 23   893      9652.277
## 24   894      5908.020
## 25   895     11018.998
## 26   896      9857.285
## 27   897     10204.266
## 28   898     14011.559
## 29   899      6062.702
## 30   900      2309.439
## 31   901      2309.439
## 32   902      6487.023
## 33   903      6550.059
## 34   904      2564.773
## 35   905     14887.217
## 36   906      5890.009
## 37   907     10590.971
## 38   908      6044.692
## 39   909      2036.095
## 40   910      2086.421
## 41   911     18180.138
## 42   912      2377.775
## 43   913      2377.775
## 44   914      9934.626
## 45   915      6222.684
## 46   916      5958.345
## 47   917      2104.431
## 48   918      5958.345
## 49   919      2086.421
## 50   920      2838.117
## 51   921      2172.767
## 52   922      2027.090
## 53   923      6350.351
## 54   924      6240.695
## 55   925     15214.592
## 56   926      2286.129
## 57   927      5944.040
## 58   928     10166.650
## 59   929      2086.421
## 60   930      2208.787
## 61   931      6345.051
## 62   932      9720.613
## 63   933      9720.613
## 64   934      2223.093
## 65   935      2086.421
## 66   936      2291.429
## 67   937     10436.289
## 68   938     10504.625
## 69   939      6550.059
## 70   940      2086.421
## 71   941      3043.125
## 72   942      9848.280
## 73   943     10832.000
## 74   944      5890.009
## 75   945      2018.085
## 76   946      5967.350
## 77   947      2086.421
## 78   948      2104.431
## 79   949      2564.773
## 80   950      6104.022
## 81   951      2523.452
## 82   952      5985.361
## 83   953      6222.684
## 84   954      2309.439
## 85   955      6172.358
## 86   956      9889.601
## 87   957     11862.340
## 88   958      2286.129
## 89   959     10768.964
## 90   960     19145.848
## 91   961      2131.446
## 92   962      5935.035
## 93   963      6505.033
## 94   964      6199.374
## 95   965      2095.426
## 96   966     18394.151
## 97   967      2122.441
## 98   968     10135.930
## 99   969     15237.902
## 100  970      2241.103
## 101  971      5798.363
## 102  972      6122.033
## 103  973      2241.103
## 104  974      2086.421
## 105  975      5958.345
## 106  976      2232.098
## 107  977      6915.050
## 108  978      2250.108
## 109  979      9724.318
## 110  980     18458.782
## 111  981      2309.439
## 112  982     10358.948
## 113  983      2309.439
## 114  984      2359.765
## 115  985      6282.015
## 116  986      2386.780
## 117  987      2086.421
## 118  988      6035.686
## 119  989     10412.979
## 120  990      2104.431
## 121  991      6386.372
## 122  992      2122.441
## 123  993      6140.043
## 124  994      6077.007
## 125  995      5967.350
## 126  996      6235.394
## 127  997      2104.431
## 128  998     14736.240
## 129  999      9797.954
## 130 1000      2027.090
## 131 1001      6710.042
## 132 1002      6077.007
## 133 1003      6062.702
## 134 1004      6864.724
## 135 1005      2345.459
## 136 1006      6291.020
## 137 1007      2036.095
## 138 1008      6300.025
## 139 1009     18248.474
## 140 1010      6327.041
## 141 1011     10614.282
## 142 1012      6555.359
## 143 1013      6089.717
## 144 1014      6071.707
## 145 1015      6291.020
## 146 1016      2446.111
## 147 1017      2226.798
## 148 1018      9779.944
## 149 1019     10035.278
## 150 1020      2018.085
## 151 1021      5935.035
## 152 1022      6213.679
## 153 1023      6095.017
## 154 1024     10923.646
## 155 1025     14189.552
## 156 1026     18144.118
## 157 1027      6350.351
## 158 1028      5899.014
## 159 1029      6008.671
## 160 1030     10736.648
## 161 1031      5890.009
## 162 1032      2226.798
## 163 1033      9592.946
## 164 1034      2086.421
## 165 1035      6071.707
## 166 1036      2027.090
## 167 1037      5908.020
## 168 1038     10486.615
## 169 1039      9948.932
## 170 1040      6427.692
## 171 1041      2190.777
## 172 1042      2309.439
## 173 1043      9898.606
## 174 1044      6312.735
## 175 1045      2122.441
## 176 1046      2086.421
## 177 1047      5976.356
## 178 1048      9797.954
## 179 1049      2149.457
## 180 1050      6095.017
## 181 1051     11242.016
## 182 1052      2149.457
## 183 1053      6163.353
## 184 1054      2309.439
## 185 1055      2309.439
## 186 1056      2309.439
## 187 1057      6145.343
## 188 1058     14139.226
## 189 1059      6618.395
## 190 1060      2190.777
## 191 1061      6149.048
## 192 1062      6231.689
## 193 1063      6345.051
## 194 1064      2104.431
## 195 1065      6436.697
## 196 1066      2241.103
## 197 1067      3266.143
## 198 1068     18548.834
## 199 1069      5899.014
## 200 1070      2172.767
## 201 1071      2359.765
## 202 1072      5911.724
## 203 1073      2036.095
## 204 1074      6003.371
## 205 1075      6145.343
## 206 1076     14549.242
## 207 1077     18189.143
## 208 1078      6300.025
## 209 1079      6003.371
## 210 1080      6915.050
## 211 1081      2446.111
## 212 1082      2232.098
## 213 1083      2086.421
## 214 1084      6226.389
## 215 1085      9661.282
## 216 1086     10107.319
## 217 1087      6026.681
## 218 1088      2368.770
## 219 1089      2250.108
## 220 1090      5908.020
## 221 1091      5798.363
## 222 1092      6107.727
## 223 1093      9720.613
## 224 1094      6035.686
## 225 1095      5848.689
## 226 1096      6104.022
## 227 1097      3061.135
## 228 1098      2309.439
## 229 1099      2149.457
## 230 1100      5944.040
## 231 1101     17788.132
## 232 1102      6104.022
## 233 1103      6327.041
## 234 1104     11607.006
## 235 1105      2505.442
## 236 1106      2505.442
## 237 1107      2158.462
## 238 1108      6300.025
## 239 1109      5798.363
## 240 1110      5908.020
## 241 1111      6226.389
## 242 1112     10171.950
## 243 1113     10062.293
## 244 1114      6787.383
## 245 1115     10508.330
## 246 1116      2386.780
## 247 1117      6906.044
## 248 1118      6122.033
## 249 1119     10855.310
## 250 1120      2208.787
## 251 1121     10819.290
## 252 1122     14955.553
## 253 1123      6003.371
## 254 1124     14198.557
## 255 1125      2154.757
## 256 1126      2086.421
## 257 1127      2309.439
## 258 1128      6113.028
## 259 1129     14435.881
## 260 1130      2232.098
## 261 1131      9948.932
## 262 1132     14486.206
## 263 1133      6300.025
## 264 1134      2113.436
## 265 1135      2464.121
## 266 1136      2250.108
## 267 1137      3001.804
## 268 1138      6003.371
## 269 1139      9842.980
## 270 1140     13473.876
## 271 1141      5944.040
## 272 1142      6300.025
## 273 1143     10822.995
## 274 1144      5890.009
## 275 1145      6573.369
## 276 1146      6222.684
## 277 1147      6026.681
## 278 1148      2172.767
## 279 1149      2104.431
## 280 1150      6012.376
## 281 1151      2113.436
## 282 1152      6282.015
## 283 1153      6924.055
## 284 1154      2086.421
## 285 1155      6176.063
## 286 1156     14604.868
## 287 1157      2241.103
## 288 1158      6760.367
## 289 1159      2172.767
## 290 1160      6154.348
## 291 1161      2309.439
## 292 1162     10135.930
## 293 1163      2176.472
## 294 1164     10153.940
## 295 1165      2149.457
## 296 1166      2036.095
## 297 1167     10349.943
## 298 1168      5908.020
## 299 1169      2250.108
## 300 1170      2149.457</code></pre>
<pre class="r"><code>write.csv(predSal,&quot;C:/Users/rache/Documents/DDS/Unit 14/Case2PredictionsLiercke_Salary.csv&quot;, row.names=FALSE)</code></pre>
</div>
<div
id="to-check-the-top-3-variables-that-lead-to-attrition-we-will-run-a-linear-regression-model-and-look-at-p-values."
class="section level2">
<h2>To check the top 3 variables that lead to attrition, we will run a
linear regression model and look at p-values.</h2>
</div>
<div
id="first-we-need-to-convert-the-variables-into-levels-in-order-to-run-a-linear-regression-model."
class="section level2">
<h2>First we need to convert the variables into levels in order to run a
linear regression model.</h2>
<pre class="r"><code>#change variables to factors and rename the levels to factored values
case2NA$BusinessTravel &lt;- as.factor(case2NA$BusinessTravel)
case2NA$Department &lt;- as.factor(case2NA$Department)
case2NA$EducationField &lt;- as.factor(case2NA$EducationField)
case2NA$Gender &lt;- as.factor(case2NA$Gender)
case2NA$JobRole &lt;- as.factor(case2NA$JobRole)
case2NA$MaritalStatus &lt;- as.factor(case2NA$MaritalStatus)
case2NA$OverTime &lt;- as.factor(case2NA$OverTime)



#Gender levels: 1=Male 2=Female
levels(case2NA$Gender) &lt;- c(1,2)
levels(case2NA$Gender)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
<pre class="r"><code>#OverTime levels: 1=Yes 2=No
levels(case2NA$OverTime) &lt;- c(1,2)
levels(case2NA$OverTime)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot;</code></pre>
<pre class="r"><code>#MaritalStatus levels: 1=Divorced 2=Married 3=Single
levels(case2NA$MaritalStatus) &lt;- c(1,2,3)
levels(case2x$MaritalStatus)</code></pre>
<pre><code>## NULL</code></pre>
<pre class="r"><code>#BusinessTravel levels:1=Non-Travel, 2=Travel Frequently 3=Travel Rarely
levels(case2NA$BusinessTravel) &lt;- c(1,2,3)
levels(case2NA$BusinessTravel)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>#Department levels: 1=Human Resources(HR) 2=Research &amp; Development(R&amp;D) 3= Sales
levels(case2NA$Department) &lt;- c(1,2,3)
levels(case2NA$Department)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<pre class="r"><code>#EducationField levels: 1= Human Resources(HR) 2=Life Sciences 3=Marketing
# 4=Medical 5=Other 6=Technical Degree
levels(case2NA$EducationField) &lt;- c(1,2,3,4,5,6)
levels(case2NA$EducationField)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot;</code></pre>
<pre class="r"><code>#JobRole levels: 1=Healthcare Representative 2=Human Resources 3=Laboratory Tech
# 4=Manager 5=Manufacturing Director 6=Research Director
# 7=Research Scientist 8=Sales Executive 9=Sales Representative
levels(case2NA$JobRole) &lt;- c(1,2,3,4,5,6,7,8,9)
levels(case2NA$JobRole)</code></pre>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot; &quot;8&quot; &quot;9&quot;</code></pre>
<pre class="r"><code>#Change the values back to numeric to make them all one variable rather than broken
#out by Job1 and Job2

case2NA$OverTime&lt;- as.numeric(case2NA$OverTime)
case2NA$BusinessTravel &lt;- as.numeric(case2NA$BusinessTravel)
case2NA$Department &lt;- as.numeric(case2NA$Department)
case2NA$EducationField &lt;- as.numeric(case2NA$EducationField)
case2NA$Gender &lt;- as.numeric(case2NA$Gender)
case2NA$JobRole &lt;- as.numeric(case2NA$JobRole)
case2NA$MaritalStatus &lt;- as.numeric(case2NA$MaritalStatus)</code></pre>
</div>
</div>
<div id="now-run-the-models-to-see-which-variables-are-most-influential"
class="section level1">
<h1>Now run the model(s) to see which variables are most
influential</h1>
<pre class="r"><code>#Run a LM model for attrition with all variables
fit&lt;- lm(Attrition~.,data=case2x)
summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Attrition ~ ., data = case2x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.58197 -0.20788 -0.08818  0.07994  1.09416 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               1.333e+00  1.909e-01   6.986 5.77e-12 ***
## ID                        9.117e-06  4.480e-05   0.203 0.838801    
## Age                      -3.260e-03  1.710e-03  -1.906 0.056928 .  
## BusinessTravel           -1.085e-03  1.656e-02  -0.066 0.947788    
## DailyRate                -2.074e-05  2.778e-05  -0.747 0.455556    
## Department                6.312e-02  2.965e-02   2.129 0.033570 *  
## DistanceFromHome          3.700e-03  1.385e-03   2.672 0.007686 ** 
## Education                -9.024e-03  1.124e-02  -0.803 0.422445    
## EducationField            4.930e-03  8.425e-03   0.585 0.558558    
## EmployeeNumber           -1.311e-05  1.845e-05  -0.710 0.477736    
## EnvironmentSatisfaction  -2.680e-02  1.016e-02  -2.637 0.008529 ** 
## Gender                    1.962e-02  2.262e-02   0.867 0.385920    
## HourlyRate                6.659e-04  5.553e-04   1.199 0.230760    
## JobInvolvement           -8.360e-02  1.589e-02  -5.260 1.83e-07 ***
## JobLevel                 -5.193e-02  3.587e-02  -1.448 0.148070    
## JobRole                  -3.332e-03  6.270e-03  -0.532 0.595210    
## JobSatisfaction          -4.473e-02  1.007e-02  -4.441 1.01e-05 ***
## MaritalStatus             7.763e-02  2.042e-02   3.803 0.000154 ***
## MonthlyIncome             6.787e-06  8.292e-06   0.818 0.413341    
## MonthlyRate              -1.156e-06  1.569e-06  -0.737 0.461583    
## NumCompaniesWorked        1.857e-02  5.084e-03   3.653 0.000276 ***
## OverTime                  2.102e-01  2.455e-02   8.562  &lt; 2e-16 ***
## PercentSalaryHike         3.812e-05  4.794e-03   0.008 0.993657    
## PerformanceRating         1.828e-02  4.892e-02   0.374 0.708707    
## RelationshipSatisfaction -2.251e-02  1.010e-02  -2.228 0.026152 *  
## StockOptionLevel         -1.128e-02  1.721e-02  -0.656 0.512186    
## TotalWorkingYears        -5.501e-03  3.332e-03  -1.651 0.099100 .  
## TrainingTimesLastYear    -1.700e-02  8.804e-03  -1.931 0.053825 .  
## WorkLifeBalance          -3.767e-02  1.565e-02  -2.406 0.016335 *  
## YearsAtCompany            5.740e-03  4.136e-03   1.388 0.165519    
## YearsInCurrentRole       -1.005e-02  5.157e-03  -1.949 0.051573 .  
## YearsSinceLastPromotion   1.617e-02  4.614e-03   3.504 0.000482 ***
## YearsWithCurrManager     -9.328e-03  5.061e-03  -1.843 0.065637 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3235 on 837 degrees of freedom
## Multiple R-squared:  0.2541, Adjusted R-squared:  0.2256 
## F-statistic: 8.912 on 32 and 837 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#Use significant variables from the initial LM model
fitA1&lt;- lm(Attrition~JobInvolvement+JobSatisfaction+MaritalStatus+NumCompaniesWorked+
           OverTime+YearsSinceLastPromotion, data=case2x)

summary(fitA1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Attrition ~ JobInvolvement + JobSatisfaction + MaritalStatus + 
##     NumCompaniesWorked + OverTime + YearsSinceLastPromotion, 
##     data = case2x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.61694 -0.20519 -0.09256  0.01547  1.05290 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              1.0152157  0.0759797  13.362  &lt; 2e-16 ***
## JobInvolvement          -0.0890882  0.0163905  -5.435 7.12e-08 ***
## JobSatisfaction         -0.0428275  0.0103562  -4.135 3.89e-05 ***
## MaritalStatus            0.0967830  0.0159605   6.064 1.98e-09 ***
## NumCompaniesWorked       0.0076166  0.0045778   1.664   0.0965 .  
## OverTime                 0.2177160  0.0253084   8.603  &lt; 2e-16 ***
## YearsSinceLastPromotion  0.0002404  0.0036166   0.066   0.9470    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3382 on 863 degrees of freedom
## Multiple R-squared:  0.1597, Adjusted R-squared:  0.1539 
## F-statistic: 27.34 on 6 and 863 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>#remove number of companies worked and try again
fitA2&lt;- lm(Attrition~JobInvolvement+JobSatisfaction+MaritalStatus+
             OverTime+YearsSinceLastPromotion, data=case2x)
summary(fitA2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Attrition ~ JobInvolvement + JobSatisfaction + MaritalStatus + 
##     OverTime + YearsSinceLastPromotion, data = case2x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63329 -0.19358 -0.09617  0.00282  1.09090 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              1.0420150  0.0743287  14.019  &lt; 2e-16 ***
## JobInvolvement          -0.0894340  0.0164059  -5.451 6.53e-08 ***
## JobSatisfaction         -0.0441637  0.0103356  -4.273 2.14e-05 ***
## MaritalStatus            0.0965061  0.0159759   6.041 2.28e-09 ***
## OverTime                 0.2177767  0.0253342   8.596  &lt; 2e-16 ***
## YearsSinceLastPromotion -0.0002034  0.0036104  -0.056    0.955    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3385 on 864 degrees of freedom
## Multiple R-squared:  0.157,  Adjusted R-squared:  0.1521 
## F-statistic: 32.19 on 5 and 864 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fitA3&lt;- lm(Attrition~JobInvolvement+JobSatisfaction+MaritalStatus+
             OverTime, data=case2x)
summary(fitA3)</code></pre>
<pre><code>## 
## Call:
## lm(formula = Attrition ~ JobInvolvement + JobSatisfaction + MaritalStatus + 
##     OverTime, data = case2x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63302 -0.19336 -0.09682  0.00082  1.08912 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.04135    0.07335  14.196  &lt; 2e-16 ***
## JobInvolvement  -0.08940    0.01639  -5.456 6.37e-08 ***
## JobSatisfaction -0.04415    0.01033  -4.275 2.12e-05 ***
## MaritalStatus    0.09654    0.01596   6.050 2.15e-09 ***
## OverTime         0.21780    0.02532   8.603  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3384 on 865 degrees of freedom
## Multiple R-squared:  0.157,  Adjusted R-squared:  0.1531 
## F-statistic: 40.28 on 4 and 865 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div
id="this-linear-regression-model-provides-us-with-job-involvement-job-satisfaction-marital-status-and-overtime-as-the-most-influential-variables-in-predicting-attrition.-using-the-p-values-to-get-the-top-three-we-would-remove-job-satisfaction-from-this-list."
class="section level1">
<h1>This linear regression model provides us with Job Involvement, Job
Satisfaction, Marital Status, and OverTime as the most influential
variables in predicting attrition. Using the p-values to get the top
three, we would remove Job Satisfaction from this list.</h1>
<div
id="our-top-three-influential-variables-are-job-involvement-marital-status-and-overtime."
class="section level2">
<h2>Our top three influential variables are Job Involvement, Marital
Status, and OverTime.</h2>
<div
id="to-test-for-attrition-we-will-use-a-smaller-model-so-we-have-a-more-even-split-of-yes-and-no"
class="section level3">
<h3>To test for attrition we will use a smaller model so we have a more
even split of yes and no</h3>
<pre class="r"><code>#Split the dataset into Attrition = Yes and Attrition = No
set.seed(100)
case2yes&lt;- case2x %&gt;% filter(Attrition == 2)
case2no&lt;- case2x %&gt;% filter(Attrition == 1)

#Create a train and test from the Attrition = Yes group
splitPerc = .70
trainIndices = sample(1:dim(case2yes)[1],round(splitPerc*dim(case2yes)[1]))
trainy = case2yes[trainIndices,]
testy = case2yes[-trainIndices,]


#Split the Attrition = No data into a train and test then use the test set to split into another train and test
splitPerc = .70
trainIndices = sample(1:dim(case2no)[1],round(splitPerc*dim(case2no)[1]))
trainN = case2no[trainIndices,]
testN = case2no[-trainIndices,]


#Split the testN into another train and test
splitPerc = .70
trainIndices = sample(1:dim(testN)[1],round(splitPerc*dim(testN)[1]))
trainN2 = testN[trainIndices,]
testN2 = testN[-trainIndices,]



#Then combine the Attrition = Yes set with the second train and test set of Attrition = No
train = full_join(trainy,trainN2)</code></pre>
<pre><code>## Joining, by = c(&quot;ID&quot;, &quot;Age&quot;, &quot;Attrition&quot;, &quot;BusinessTravel&quot;, &quot;DailyRate&quot;,
## &quot;Department&quot;, &quot;DistanceFromHome&quot;, &quot;Education&quot;, &quot;EducationField&quot;,
## &quot;EmployeeNumber&quot;, &quot;EnvironmentSatisfaction&quot;, &quot;Gender&quot;, &quot;HourlyRate&quot;,
## &quot;JobInvolvement&quot;, &quot;JobLevel&quot;, &quot;JobRole&quot;, &quot;JobSatisfaction&quot;, &quot;MaritalStatus&quot;,
## &quot;MonthlyIncome&quot;, &quot;MonthlyRate&quot;, &quot;NumCompaniesWorked&quot;, &quot;OverTime&quot;,
## &quot;PercentSalaryHike&quot;, &quot;PerformanceRating&quot;, &quot;RelationshipSatisfaction&quot;,
## &quot;StockOptionLevel&quot;, &quot;TotalWorkingYears&quot;, &quot;TrainingTimesLastYear&quot;,
## &quot;WorkLifeBalance&quot;, &quot;YearsAtCompany&quot;, &quot;YearsInCurrentRole&quot;,
## &quot;YearsSinceLastPromotion&quot;, &quot;YearsWithCurrManager&quot;)</code></pre>
<pre class="r"><code>test = full_join(testy,testN2)</code></pre>
<pre><code>## Joining, by = c(&quot;ID&quot;, &quot;Age&quot;, &quot;Attrition&quot;, &quot;BusinessTravel&quot;, &quot;DailyRate&quot;,
## &quot;Department&quot;, &quot;DistanceFromHome&quot;, &quot;Education&quot;, &quot;EducationField&quot;,
## &quot;EmployeeNumber&quot;, &quot;EnvironmentSatisfaction&quot;, &quot;Gender&quot;, &quot;HourlyRate&quot;,
## &quot;JobInvolvement&quot;, &quot;JobLevel&quot;, &quot;JobRole&quot;, &quot;JobSatisfaction&quot;, &quot;MaritalStatus&quot;,
## &quot;MonthlyIncome&quot;, &quot;MonthlyRate&quot;, &quot;NumCompaniesWorked&quot;, &quot;OverTime&quot;,
## &quot;PercentSalaryHike&quot;, &quot;PerformanceRating&quot;, &quot;RelationshipSatisfaction&quot;,
## &quot;StockOptionLevel&quot;, &quot;TotalWorkingYears&quot;, &quot;TrainingTimesLastYear&quot;,
## &quot;WorkLifeBalance&quot;, &quot;YearsAtCompany&quot;, &quot;YearsInCurrentRole&quot;,
## &quot;YearsSinceLastPromotion&quot;, &quot;YearsWithCurrManager&quot;)</code></pre>
<pre class="r"><code>combined = full_join(train,test)</code></pre>
<pre><code>## Joining, by = c(&quot;ID&quot;, &quot;Age&quot;, &quot;Attrition&quot;, &quot;BusinessTravel&quot;, &quot;DailyRate&quot;,
## &quot;Department&quot;, &quot;DistanceFromHome&quot;, &quot;Education&quot;, &quot;EducationField&quot;,
## &quot;EmployeeNumber&quot;, &quot;EnvironmentSatisfaction&quot;, &quot;Gender&quot;, &quot;HourlyRate&quot;,
## &quot;JobInvolvement&quot;, &quot;JobLevel&quot;, &quot;JobRole&quot;, &quot;JobSatisfaction&quot;, &quot;MaritalStatus&quot;,
## &quot;MonthlyIncome&quot;, &quot;MonthlyRate&quot;, &quot;NumCompaniesWorked&quot;, &quot;OverTime&quot;,
## &quot;PercentSalaryHike&quot;, &quot;PerformanceRating&quot;, &quot;RelationshipSatisfaction&quot;,
## &quot;StockOptionLevel&quot;, &quot;TotalWorkingYears&quot;, &quot;TrainingTimesLastYear&quot;,
## &quot;WorkLifeBalance&quot;, &quot;YearsAtCompany&quot;, &quot;YearsInCurrentRole&quot;,
## &quot;YearsSinceLastPromotion&quot;, &quot;YearsWithCurrManager&quot;)</code></pre>
</div>
</div>
<div
id="using-the-datasets-created-in-the-last-step-we-will-train-a-model-to-predict-if-the-employee-stays-or-not."
class="section level2">
<h2>Using the datasets created in the last step, we will train a model
to predict if the employee stays or not.</h2>
<pre class="r"><code>iterations = 500
masterSpec = matrix(nrow = iterations)
masterSens = matrix(nrow = iterations)
splitPerc = .7 #Training / Test split Percentage
for(j in 1:iterations)
{
  
  trainIndices = sample(1:dim(combined)[1],round(splitPerc * dim(combined)[1]))
  train1 = combined[trainIndices,]
  test1 = combined[-trainIndices,]
  
  model = naiveBayes(train1[,c(3,6,7,11,14,17,18,21,22,29,31,32,33)],train1$Attrition,laplace = 1)
  table(predict(model,test1[,c(3,6,7,11,14,17,18,21,22,29,31,32,33)]),test1$Attrition)
  CM = confusionMatrix(table(predict(model,test1[,c(3,6,7,11,14,17,18,21,22,29,31,32,33)]),test1$Attrition))
  masterSpec[j] = CM$byClass[2]
  masterSens[j] = CM$byClass[1]
}
MeanSpec = colMeans(masterSpec)
MeanSpec</code></pre>
<pre><code>## [1] 0.9998154</code></pre>
<pre class="r"><code>MeanSens = colMeans(masterSens)
MeanSens</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="r"><code>model = naiveBayes(train1[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)],train1$Attrition,laplace = 1)
table(predict(model,test1[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)]),test1$Attrition)</code></pre>
<pre><code>##    
##      1  2
##   1 66  0
##   2  0 42</code></pre>
<pre class="r"><code>confusionMatrix(table(predict(model,test1[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)]),test1$Attrition))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##    
##      1  2
##   1 66  0
##   2  0 42
##                                      
##                Accuracy : 1          
##                  95% CI : (0.9664, 1)
##     No Information Rate : 0.6111     
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16  
##                                      
##                   Kappa : 1          
##                                      
##  Mcnemar&#39;s Test P-Value : NA         
##                                      
##             Sensitivity : 1.0000     
##             Specificity : 1.0000     
##          Pos Pred Value : 1.0000     
##          Neg Pred Value : 1.0000     
##              Prevalence : 0.6111     
##          Detection Rate : 0.6111     
##    Detection Prevalence : 0.6111     
##       Balanced Accuracy : 1.0000     
##                                      
##        &#39;Positive&#39; Class : 1          
## </code></pre>
<pre class="r"><code>CM = confusionMatrix(table(predict(model,test1[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)]),test1$Attrition))</code></pre>
</div>
<div id="we-then-tested-this-model-on-the-overall-dataset."
class="section level2">
<h2>We then tested this model on the overall dataset.</h2>
<pre class="r"><code>set.seed(75)
splitPerc = .7
trainIndices = sample(1:dim(case2x)[1],round(splitPerc * dim(case2x)[1]))
trainOverall = case2x[trainIndices,]
testOverall = case2x[-trainIndices,]
model = naiveBayes(trainOverall[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)],trainOverall$Attrition,laplace = 1)
table(predict(model,testOverall[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)]),testOverall$Attrition)</code></pre>
<pre><code>##    
##       1   2
##   1 215   0
##   2   0  46</code></pre>
<pre class="r"><code>confusionMatrix(table(predict(model,testOverall[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)]),testOverall$Attrition))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##    
##       1   2
##   1 215   0
##   2   0  46
##                                     
##                Accuracy : 1         
##                  95% CI : (0.986, 1)
##     No Information Rate : 0.8238    
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16 
##                                     
##                   Kappa : 1         
##                                     
##  Mcnemar&#39;s Test P-Value : NA        
##                                     
##             Sensitivity : 1.0000    
##             Specificity : 1.0000    
##          Pos Pred Value : 1.0000    
##          Neg Pred Value : 1.0000    
##              Prevalence : 0.8238    
##          Detection Rate : 0.8238    
##    Detection Prevalence : 0.8238    
##       Balanced Accuracy : 1.0000    
##                                     
##        &#39;Positive&#39; Class : 1         
## </code></pre>
</div>
<div
id="this-model-ended-up-getting-over-60-specificity-and-sensitivity.-we-used-this-to-predict-the-dataset-that-didnt-have-attrition-values."
class="section level2">
<h2>This model ended up getting over 60% specificity and sensitivity. We
used this to predict the dataset that didn’t have Attrition values.</h2>
<pre class="r"><code>#Predict the data-set without Attrition using this model

case2NA2 &lt;- case2NA
case2NA2 &lt;- case2NA[,-9]
case2NA2 &lt;- case2NA2[,-21]
case2NA2 &lt;- case2NA2[,-25]
model = naiveBayes(trainOverall[,c(3,6,7,11,14,17,18,21,22,27,29,31,32,33)],trainOverall$Attrition,laplace = 1)
case2NA2$Attrition = &quot;Attrition&quot;
case2NA2 &lt;- case2NA2 %&gt;% relocate(Attrition, .before = Age)
predictionAtt = predict(model,case2NA2)</code></pre>
<pre><code>## Warning in predict.naiveBayes(model, case2NA2): Type mismatch between training
## and new data for variable &#39;Attrition&#39;. Did you use factors with numeric labels
## for training, and numeric values for new data?</code></pre>
<pre class="r"><code>predictionAtt</code></pre>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 2 1 1 1
##  [38] 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1
##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 2 2 1 1 1 1 1 1 2 2
## [149] 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1
## [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [223] 1 1 1 1 1 1 2 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 2 1 1 1 1 1 1 1 1
## [260] 1 1 1 1 1 1 1 1 1 2 1 2 1 1 1 1 1 1 1 2 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1
## [297] 1 2 1 1
## Levels: 1 2</code></pre>
<pre class="r"><code>predictionAtt2&lt;- data.frame(Attrition = predictionAtt)
predAtt = data.frame(ID = case2NA[1], Attrition = predictionAtt2)
levels(predAtt$Attrition) &lt;- c(&quot;No&quot;, &quot;Yes&quot;)
levels(predAtt$Attrition)</code></pre>
<pre><code>## [1] &quot;No&quot;  &quot;Yes&quot;</code></pre>
<pre class="r"><code>write.csv(predAtt,&quot;C:/Users/rache/Documents/DDS/Unit 14/Case2PredictionsLiercke_Attrition.csv&quot;, row.names=FALSE)</code></pre>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion:</h1>
<div
id="we-were-able-to-explore-job-role-trends-predict-monthly-income-and-predict-attrition.-all-of-this-will-be-discussed-in-the-powerpoint-presentation-and-the-executive-summary-given-out-at-a-later-time."
class="section level2">
<h2>We were able to explore Job Role Trends, predict Monthly Income, and
predict Attrition. All of this will be discussed in the powerpoint
presentation and the executive summary given out at a later time.</h2>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
